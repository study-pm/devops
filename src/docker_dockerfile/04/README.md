# Lab #4: Create an image with CMD instruction
https://dockerlabs.collabnix.com//beginners/dockerfile/lab4_cmd.html

- [Command Line Tools](#command-line-tools)
  - [Start the service](#start-the-service)
  - [Stop the service](#stop-the-service)
  - [Underlying commands](#underlying-commands)
    - [Pre-requisite](#pre-requisite)
    - [Creating Dockerfile](#creating-dockerfile)
    - [Building Docker Container](#building-docker-container)
    - [Running the Docker container](#running-the-docker-container)
- [Utils / Trivia](#utils--trivia)
  - [Exit the container shell](#exit-the-container-shell)
- [Troubleshooting](#troubleshooting)
  - [Fix `permission denied` error](#fix-permission-denied-error)
  - [Fix `failed to read dockerfile` error](#fix-failed-to-read-dockerfile-error)

## Command Line Tools
There are two prime commands for managing (starting and stopping) the provided service.

### Start the service
The following command runs the full command sequence:
```sh
$ ./start
```

alternatively:
```sh
$ sh start
```

### Stop the service
The following command clears all of the output (removing all possible side-effects) generated by running the *start* command:
```sh
$ ./clear
```

alternatively:
```sh
$ sh clear
```

### Underlying commands
There are multiple underlying scripts used for building the service functions. The sections below describe the commands used for managing the provided service and building the necessary resources.

#### Pre-requisite
There should be the following files (committed) in your working directory:
- *Dockerfile_cmd*

In case any of them missing, run the *[create.sh](./create.sh)* script before executing the *start* command.

#### Creating Dockerfile
*Dockerfile*
```docker
FROM alpine:3.6

RUN apk update
CMD ["top"]
```

Placed into *[create.sh](./create.sh)*.

#### Building Docker Container
```sh
$ docker build -t ajeetraina/lab3_cmd . -f Dockerfile_cmd
```

Placed into *[build.sh](./build.sh)*.

#### Running the Docker container
```sh
$ docker run ajeetraina/lab3_cmd:latest
```

Placed into *[run.sh](./run.sh)*.

## Utils / Trivia

### Exit the container shell
Press <kbd>Ctrl</kbd> + <kbd>c</kbd> to exit the container shell. This stops the running container.

If you want to detach from a container without stopping it, type <kbd>Ctrl</kbd> + <kbd>p</kbd> then <kbd>Ctrl</kbd> + <kbd>q</kbd>. It will help you to turn interactive mode to daemon mode.

## Troubleshooting

### Fix `permission denied` error
If you get the *permission denied* error while building the service scripts, make the script file executable:
```sh
$ chmod +x start
```

or:
```
$ chmod u+x clear
```

### Fix `failed to read dockerfile` error
If you get the *ERROR: failed to solve: failed to read dockerfile* error while running the service, probably you have your *Dockerfile* or other crucial static files missing. Run the *[create.sh](./create.sh)* script before executing the *start* command.
